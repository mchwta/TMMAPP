{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { WebPlugin } from './index';\nvar LocalNotificationsPluginWeb = /** @class */function (_super) {\n  __extends(LocalNotificationsPluginWeb, _super);\n  function LocalNotificationsPluginWeb() {\n    var _this = _super.call(this, {\n      name: 'LocalNotifications',\n      platforms: ['web']\n    }) || this;\n    _this.pending = [];\n    return _this;\n  }\n  LocalNotificationsPluginWeb.prototype.createChannel = function (channel) {\n    throw new Error('Feature not available in the browser. ' + channel.id);\n  };\n  LocalNotificationsPluginWeb.prototype.deleteChannel = function (channel) {\n    throw new Error('Feature not available in the browser. ' + channel.id);\n  };\n  LocalNotificationsPluginWeb.prototype.listChannels = function () {\n    throw new Error('Feature not available in the browser');\n  };\n  LocalNotificationsPluginWeb.prototype.sendPending = function () {\n    var _this = this;\n    var toRemove = [];\n    var now = +new Date();\n    this.pending.forEach(function (localNotification) {\n      if (localNotification.schedule && localNotification.schedule.at) {\n        if (+localNotification.schedule.at <= now) {\n          _this.buildNotification(localNotification);\n          toRemove.push(localNotification);\n        }\n      }\n    });\n    console.log('Sent pending, removing', toRemove);\n    this.pending = this.pending.filter(function (localNotification) {\n      return !toRemove.find(function (ln) {\n        return ln === localNotification;\n      });\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.sendNotification = function (localNotification) {\n    var _this = this;\n    var l = localNotification;\n    if (localNotification.schedule && localNotification.schedule.at) {\n      var diff = +localNotification.schedule.at - +new Date();\n      this.pending.push(l);\n      setTimeout(function () {\n        _this.sendPending();\n      }, diff);\n      return;\n    }\n    this.buildNotification(localNotification);\n  };\n  LocalNotificationsPluginWeb.prototype.buildNotification = function (localNotification) {\n    var l = localNotification;\n    return new Notification(l.title, {\n      body: l.body\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.schedule = function (options) {\n    var _this = this;\n    var notifications = [];\n    options.notifications.forEach(function (notification) {\n      notifications.push(_this.sendNotification(notification));\n    });\n    return Promise.resolve({\n      notifications: options.notifications.map(function (notification) {\n        return {\n          id: '' + notification.id\n        };\n      })\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.getPending = function () {\n    return Promise.resolve({\n      notifications: this.pending.map(function (localNotification) {\n        return {\n          id: '' + localNotification.id\n        };\n      })\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.registerActionTypes = function (_options) {\n    throw new Error('Method not implemented.');\n  };\n  LocalNotificationsPluginWeb.prototype.cancel = function (pending) {\n    console.log('Cancel these', pending);\n    this.pending = this.pending.filter(function (localNotification) {\n      return !pending.notifications.find(function (ln) {\n        return ln.id === '' + localNotification.id;\n      });\n    });\n    return Promise.resolve();\n  };\n  LocalNotificationsPluginWeb.prototype.areEnabled = function () {\n    return Promise.resolve({\n      value: Notification.permission === 'granted'\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.requestPermission = function () {\n    return new Promise(function (resolve) {\n      Notification.requestPermission(function (result) {\n        var granted = true;\n        if (result === 'denied' || result === 'default') {\n          granted = false;\n        }\n        resolve({\n          granted: granted\n        });\n      });\n    });\n  };\n  LocalNotificationsPluginWeb.prototype.requestPermissions = function () {\n    return new Promise(function (resolve, reject) {\n      Notification.requestPermission(function (result) {\n        if (result === 'denied' || result === 'default') {\n          reject(result);\n          return;\n        }\n        resolve({\n          results: [result]\n        });\n      });\n    });\n  };\n  return LocalNotificationsPluginWeb;\n}(WebPlugin);\nexport { LocalNotificationsPluginWeb };\nvar LocalNotifications = new LocalNotificationsPluginWeb();\nexport { LocalNotifications };","map":{"version":3,"names":["WebPlugin","LocalNotificationsPluginWeb","_super","__extends","_this","call","name","platforms","pending","prototype","createChannel","channel","Error","id","deleteChannel","listChannels","sendPending","toRemove","now","Date","forEach","localNotification","schedule","at","buildNotification","push","console","log","filter","find","ln","sendNotification","l","diff","setTimeout","Notification","title","body","options","notifications","notification","Promise","resolve","map","getPending","registerActionTypes","_options","cancel","areEnabled","value","permission","requestPermission","result","granted","requestPermissions","reject","results","LocalNotifications"],"sources":["../../../src/web/local-notifications.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module"}