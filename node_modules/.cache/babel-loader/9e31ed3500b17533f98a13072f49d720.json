{"ast":null,"code":"import { __awaiter, __extends, __generator } from \"tslib\";\nimport { WebPlugin } from './index';\nvar ClipboardPluginWeb = /** @class */function (_super) {\n  __extends(ClipboardPluginWeb, _super);\n  function ClipboardPluginWeb() {\n    return _super.call(this, {\n      name: 'Clipboard',\n      platforms: ['web']\n    }) || this;\n  }\n  ClipboardPluginWeb.prototype.write = function (options) {\n    return __awaiter(this, void 0, void 0, function () {\n      var blob, clipboardItemInput, err_1;\n      var _a;\n      return __generator(this, function (_b) {\n        switch (_b.label) {\n          case 0:\n            if (!navigator.clipboard) {\n              return [2 /*return*/, Promise.reject('Clipboard API not available in this browser')];\n            }\n            if (!(options.string !== undefined || options.url)) return [3 /*break*/, 2];\n            if (!navigator.clipboard.writeText) {\n              return [2 /*return*/, Promise.reject('Writting to clipboard not supported in this browser')];\n            }\n            return [4 /*yield*/, navigator.clipboard.writeText(options.string !== undefined ? options.string : options.url)];\n          case 1:\n            _b.sent();\n            return [3 /*break*/, 10];\n          case 2:\n            if (!options.image) return [3 /*break*/, 9];\n            if (!navigator.clipboard.write) {\n              return [2 /*return*/, Promise.reject('Setting images not supported in this browser')];\n            }\n            _b.label = 3;\n          case 3:\n            _b.trys.push([3, 7,, 8]);\n            return [4 /*yield*/, fetch(options.image)];\n          case 4:\n            return [4 /*yield*/, _b.sent().blob()];\n          case 5:\n            blob = _b.sent();\n            clipboardItemInput = new ClipboardItem((_a = {}, _a[blob.type] = blob, _a));\n            return [4 /*yield*/, navigator.clipboard.write([clipboardItemInput])];\n          case 6:\n            _b.sent();\n            return [3 /*break*/, 8];\n          case 7:\n            err_1 = _b.sent();\n            return [2 /*return*/, Promise.reject('Failed to write image')];\n          case 8:\n            return [3 /*break*/, 10];\n          case 9:\n            return [2 /*return*/, Promise.reject('Nothing to write')];\n          case 10:\n            return [2 /*return*/, Promise.resolve()];\n        }\n      });\n    });\n  };\n  ClipboardPluginWeb.prototype.read = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var clipboardItems, type, clipboardBlob, data, err_2;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            if (!navigator.clipboard) {\n              return [2 /*return*/, Promise.reject('Clipboard API not available in this browser')];\n            }\n            if (!!navigator.clipboard.read) return [3 /*break*/, 1];\n            if (!navigator.clipboard.readText) {\n              return [2 /*return*/, Promise.reject('Reading from clipboard not supported in this browser')];\n            }\n            return [2 /*return*/, this.readText()];\n          case 1:\n            _a.trys.push([1, 5,, 6]);\n            return [4 /*yield*/, navigator.clipboard.read()];\n          case 2:\n            clipboardItems = _a.sent();\n            type = clipboardItems[0].types[0];\n            return [4 /*yield*/, clipboardItems[0].getType(type)];\n          case 3:\n            clipboardBlob = _a.sent();\n            return [4 /*yield*/, this._getBlobData(clipboardBlob, type)];\n          case 4:\n            data = _a.sent();\n            return [2 /*return*/, Promise.resolve({\n              value: data,\n              type: type\n            })];\n          case 5:\n            err_2 = _a.sent();\n            return [2 /*return*/, this.readText()];\n          case 6:\n            return [2 /*return*/];\n        }\n      });\n    });\n  };\n\n  ClipboardPluginWeb.prototype.readText = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var text;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            return [4 /*yield*/, navigator.clipboard.readText()];\n          case 1:\n            text = _a.sent();\n            return [2 /*return*/, Promise.resolve({\n              value: text,\n              type: 'text/plain'\n            })];\n        }\n      });\n    });\n  };\n  ClipboardPluginWeb.prototype._getBlobData = function (clipboardBlob, type) {\n    return new Promise(function (resolve, reject) {\n      var reader = new FileReader();\n      if (type.includes('image')) {\n        reader.readAsDataURL(clipboardBlob);\n      } else {\n        reader.readAsText(clipboardBlob);\n      }\n      reader.onloadend = function () {\n        var r = reader.result;\n        resolve(r);\n      };\n      reader.onerror = function (e) {\n        reject(e);\n      };\n    });\n  };\n  return ClipboardPluginWeb;\n}(WebPlugin);\nexport { ClipboardPluginWeb };\nvar Clipboard = new ClipboardPluginWeb();\nexport { Clipboard };","map":{"version":3,"names":["WebPlugin","ClipboardPluginWeb","_super","__extends","call","name","platforms","prototype","write","options","navigator","clipboard","Promise","reject","string","undefined","url","writeText","_b","sent","image","fetch","blob","clipboardItemInput","ClipboardItem","_a","type","resolve","read","readText","clipboardItems","types","getType","clipboardBlob","_getBlobData","data","value","text","reader","FileReader","includes","readAsDataURL","readAsText","onloadend","r","result","onerror","e","Clipboard"],"sources":["../../../src/web/clipboard.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module"}