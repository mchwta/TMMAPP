{"ast":null,"code":"var WebPluginRegistry = /** @class */function () {\n  function WebPluginRegistry() {\n    this.plugins = {};\n    this.loadedPlugins = {};\n  }\n  WebPluginRegistry.prototype.addPlugin = function (plugin) {\n    this.plugins[plugin.config.name] = plugin;\n  };\n  WebPluginRegistry.prototype.getPlugin = function (name) {\n    return this.plugins[name];\n  };\n  WebPluginRegistry.prototype.loadPlugin = function (name) {\n    var plugin = this.getPlugin(name);\n    if (!plugin) {\n      console.error(\"Unable to load web plugin \" + name + \", no such plugin found.\");\n      return;\n    }\n    plugin.load();\n  };\n  WebPluginRegistry.prototype.getPlugins = function () {\n    var p = [];\n    for (var name_1 in this.plugins) {\n      p.push(this.plugins[name_1]);\n    }\n    return p;\n  };\n  return WebPluginRegistry;\n}();\nexport { WebPluginRegistry };\nvar WebPlugins = new WebPluginRegistry();\nexport { WebPlugins };\nvar WebPlugin = /** @class */function () {\n  function WebPlugin(config, pluginRegistry) {\n    this.config = config;\n    this.loaded = false;\n    this.listeners = {};\n    this.windowListeners = {};\n    if (!pluginRegistry) {\n      WebPlugins.addPlugin(this);\n    } else {\n      pluginRegistry.addPlugin(this);\n    }\n  }\n  WebPlugin.prototype.addWindowListener = function (handle) {\n    window.addEventListener(handle.windowEventName, handle.handler);\n    handle.registered = true;\n  };\n  WebPlugin.prototype.removeWindowListener = function (handle) {\n    if (!handle) {\n      return;\n    }\n    window.removeEventListener(handle.windowEventName, handle.handler);\n    handle.registered = false;\n  };\n  WebPlugin.prototype.addListener = function (eventName, listenerFunc) {\n    var _this = this;\n    var listeners = this.listeners[eventName];\n    if (!listeners) {\n      this.listeners[eventName] = [];\n    }\n    this.listeners[eventName].push(listenerFunc);\n    // If we haven't added a window listener for this event and it requires one,\n    // go ahead and add it\n    var windowListener = this.windowListeners[eventName];\n    if (windowListener && !windowListener.registered) {\n      this.addWindowListener(windowListener);\n    }\n    return {\n      remove: function remove() {\n        _this.removeListener(eventName, listenerFunc);\n      }\n    };\n  };\n  WebPlugin.prototype.removeListener = function (eventName, listenerFunc) {\n    var listeners = this.listeners[eventName];\n    if (!listeners) {\n      return;\n    }\n    var index = listeners.indexOf(listenerFunc);\n    this.listeners[eventName].splice(index, 1);\n    // If there are no more listeners for this type of event,\n    // remove the window listener\n    if (!this.listeners[eventName].length) {\n      this.removeWindowListener(this.windowListeners[eventName]);\n    }\n  };\n  WebPlugin.prototype.removeAllListeners = function () {\n    this.listeners = {};\n    for (var listener in this.windowListeners) {\n      this.removeWindowListener(this.windowListeners[listener]);\n    }\n    this.windowListeners = {};\n  };\n  WebPlugin.prototype.notifyListeners = function (eventName, data) {\n    var listeners = this.listeners[eventName];\n    if (listeners) {\n      listeners.forEach(function (listener) {\n        return listener(data);\n      });\n    }\n  };\n  WebPlugin.prototype.hasListeners = function (eventName) {\n    return !!this.listeners[eventName].length;\n  };\n  WebPlugin.prototype.registerWindowListener = function (windowEventName, pluginEventName) {\n    var _this = this;\n    this.windowListeners[pluginEventName] = {\n      registered: false,\n      windowEventName: windowEventName,\n      pluginEventName: pluginEventName,\n      handler: function handler(event) {\n        _this.notifyListeners(pluginEventName, event);\n      }\n    };\n  };\n  WebPlugin.prototype.requestPermissions = function () {\n    if (Capacitor.isNative) {\n      return Capacitor.nativePromise(this.config.name, 'requestPermissions', {});\n    } else {\n      return Promise.resolve({\n        results: []\n      });\n    }\n  };\n  WebPlugin.prototype.load = function () {\n    this.loaded = true;\n  };\n  return WebPlugin;\n}();\nexport { WebPlugin };\nvar shouldMergeWebPlugin = function shouldMergeWebPlugin(plugin) {\n  return plugin.config.platforms && plugin.config.platforms.indexOf(Capacitor.platform) >= 0;\n};\n/**\n * For all our known web plugins, merge them into the global plugins\n * registry if they aren't already existing. If they don't exist, that\n * means there's no existing native implementation for it.\n * @param knownPlugins the Capacitor.Plugins global registry.\n */\nexport var mergeWebPlugins = function mergeWebPlugins(knownPlugins) {\n  var plugins = WebPlugins.getPlugins();\n  for (var _i = 0, plugins_1 = plugins; _i < plugins_1.length; _i++) {\n    var plugin = plugins_1[_i];\n    mergeWebPlugin(knownPlugins, plugin);\n  }\n};\nexport var mergeWebPlugin = function mergeWebPlugin(knownPlugins, plugin) {\n  // If we already have a plugin registered (meaning it was defined in the native layer),\n  // then we should only overwrite it if the corresponding web plugin activates on\n  // a certain platform. For example: Geolocation uses the WebPlugin on Android but not iOS\n  if (knownPlugins.hasOwnProperty(plugin.config.name) && !shouldMergeWebPlugin(plugin)) {\n    return;\n  }\n  knownPlugins[plugin.config.name] = plugin;\n};","map":{"version":3,"names":["WebPluginRegistry","plugins","loadedPlugins","prototype","addPlugin","plugin","config","name","getPlugin","loadPlugin","console","error","load","getPlugins","p","name_1","push","WebPlugins","WebPlugin","pluginRegistry","loaded","listeners","windowListeners","addWindowListener","handle","window","addEventListener","windowEventName","handler","registered","removeWindowListener","removeEventListener","addListener","eventName","listenerFunc","_this","windowListener","remove","removeListener","index","indexOf","splice","length","removeAllListeners","listener","notifyListeners","data","forEach","hasListeners","registerWindowListener","pluginEventName","event","requestPermissions","Capacitor","isNative","nativePromise","Promise","resolve","results","shouldMergeWebPlugin","platforms","platform","mergeWebPlugins","knownPlugins","_i","plugins_1","mergeWebPlugin","hasOwnProperty"],"sources":["../../../src/web/index.ts"],"sourcesContent":[null],"mappings":"AAQA,IAAAA,iBAAA;EAIE,SAAAA,kBAAA;IAHA,KAAAC,OAAO,GAAkC,EAAE;IAC3C,KAAAC,aAAa,GAAkC,EAAE;EAGjD;EAEAF,iBAAA,CAAAG,SAAA,CAAAC,SAAS,GAAT,UAAUC,MAAiB;IACzB,IAAI,CAACJ,OAAO,CAACI,MAAM,CAACC,MAAM,CAACC,IAAI,CAAC,GAAGF,MAAM;EAC3C,CAAC;EAEDL,iBAAA,CAAAG,SAAA,CAAAK,SAAS,GAAT,UAAUD,IAAY;IACpB,OAAO,IAAI,CAACN,OAAO,CAACM,IAAI,CAAC;EAC3B,CAAC;EAEDP,iBAAA,CAAAG,SAAA,CAAAM,UAAU,GAAV,UAAWF,IAAY;IACrB,IAAIF,MAAM,GAAG,IAAI,CAACG,SAAS,CAACD,IAAI,CAAC;IACjC,IAAI,CAACF,MAAM,EAAE;MACXK,OAAO,CAACC,KAAK,CAAC,+BAA6BJ,IAAI,4BAAyB,CAAC;MACzE;;IAGFF,MAAM,CAACO,IAAI,EAAE;EACf,CAAC;EAEDZ,iBAAA,CAAAG,SAAA,CAAAU,UAAU,GAAV;IACE,IAAIC,CAAC,GAAG,EAAE;IACV,KAAK,IAAIC,MAAI,IAAI,IAAI,CAACd,OAAO,EAAE;MAC7Ba,CAAC,CAACE,IAAI,CAAC,IAAI,CAACf,OAAO,CAACc,MAAI,CAAC,CAAC;;IAE5B,OAAOD,CAAC;EACV,CAAC;EACH,OAAAd,iBAAC;AAAD,CAAC,EAhCD;;AAkCA,IAAIiB,UAAU,GAAG,IAAIjB,iBAAiB,EAAE;AACxC,SAASiB,UAAU;AAuBnB,IAAAC,SAAA;EAME,SAAAA,UAAmBZ,MAAuB,EAAEa,cAAkC;IAA3D,KAAAb,MAAM,GAANA,MAAM;IALzB,KAAAc,MAAM,GAAY,KAAK;IAEvB,KAAAC,SAAS,GAAgD,EAAE;IAC3D,KAAAC,eAAe,GAAkD,EAAE;IAGjE,IAAI,CAACH,cAAc,EAAE;MACnBF,UAAU,CAACb,SAAS,CAAC,IAAI,CAAC;KAC3B,MAAM;MACLe,cAAc,CAACf,SAAS,CAAC,IAAI,CAAC;;EAElC;EAEQc,SAAA,CAAAf,SAAA,CAAAoB,iBAAiB,GAAzB,UAA0BC,MAA4B;IACpDC,MAAM,CAACC,gBAAgB,CAACF,MAAM,CAACG,eAAe,EAAEH,MAAM,CAACI,OAAO,CAAC;IAC/DJ,MAAM,CAACK,UAAU,GAAG,IAAI;EAC1B,CAAC;EAEOX,SAAA,CAAAf,SAAA,CAAA2B,oBAAoB,GAA5B,UAA6BN,MAA4B;IACvD,IAAI,CAACA,MAAM,EAAE;MAAE;;IAEfC,MAAM,CAACM,mBAAmB,CAACP,MAAM,CAACG,eAAe,EAAEH,MAAM,CAACI,OAAO,CAAC;IAClEJ,MAAM,CAACK,UAAU,GAAG,KAAK;EAC3B,CAAC;EAEDX,SAAA,CAAAf,SAAA,CAAA6B,WAAW,GAAX,UAAYC,SAAiB,EAAEC,YAA8B;IAA7D,IAAAC,KAAA;IACE,IAAId,SAAS,GAAG,IAAI,CAACA,SAAS,CAACY,SAAS,CAAC;IACzC,IAAI,CAACZ,SAAS,EAAE;MACd,IAAI,CAACA,SAAS,CAACY,SAAS,CAAC,GAAG,EAAE;;IAGhC,IAAI,CAACZ,SAAS,CAACY,SAAS,CAAC,CAACjB,IAAI,CAACkB,YAAY,CAAC;IAE5C;IACA;IACA,IAAIE,cAAc,GAAG,IAAI,CAACd,eAAe,CAACW,SAAS,CAAC;IACpD,IAAIG,cAAc,IAAI,CAACA,cAAc,CAACP,UAAU,EAAE;MAChD,IAAI,CAACN,iBAAiB,CAACa,cAAc,CAAC;;IAGxC,OAAO;MACLC,MAAM,EAAE,SAAAA,OAAA;QACNF,KAAI,CAACG,cAAc,CAACL,SAAS,EAAEC,YAAY,CAAC;MAC9C;KACD;EACH,CAAC;EAEOhB,SAAA,CAAAf,SAAA,CAAAmC,cAAc,GAAtB,UAAuBL,SAAiB,EAAEC,YAA8B;IACtE,IAAIb,SAAS,GAAG,IAAI,CAACA,SAAS,CAACY,SAAS,CAAC;IACzC,IAAI,CAACZ,SAAS,EAAE;MACd;;IAGF,IAAIkB,KAAK,GAAGlB,SAAS,CAACmB,OAAO,CAACN,YAAY,CAAC;IAC3C,IAAI,CAACb,SAAS,CAACY,SAAS,CAAC,CAACQ,MAAM,CAACF,KAAK,EAAE,CAAC,CAAC;IAE1C;IACA;IACA,IAAI,CAAC,IAAI,CAAClB,SAAS,CAACY,SAAS,CAAC,CAACS,MAAM,EAAE;MACrC,IAAI,CAACZ,oBAAoB,CAAC,IAAI,CAACR,eAAe,CAACW,SAAS,CAAC,CAAC;;EAE9D,CAAC;EAEDf,SAAA,CAAAf,SAAA,CAAAwC,kBAAkB,GAAlB;IACE,IAAI,CAACtB,SAAS,GAAG,EAAE;IACnB,KAAK,IAAMuB,QAAQ,IAAI,IAAI,CAACtB,eAAe,EAAE;MAC3C,IAAI,CAACQ,oBAAoB,CAAC,IAAI,CAACR,eAAe,CAACsB,QAAQ,CAAC,CAAC;;IAE3D,IAAI,CAACtB,eAAe,GAAG,EAAE;EAC3B,CAAC;EAEDJ,SAAA,CAAAf,SAAA,CAAA0C,eAAe,GAAf,UAAgBZ,SAAiB,EAAEa,IAAS;IAC1C,IAAIzB,SAAS,GAAG,IAAI,CAACA,SAAS,CAACY,SAAS,CAAC;IACzC,IAAIZ,SAAS,EAAE;MACbA,SAAS,CAAC0B,OAAO,CAAC,UAAAH,QAAQ;QAAI,OAAAA,QAAQ,CAACE,IAAI,CAAC;MAAd,CAAc,CAAC;;EAEjD,CAAC;EAED5B,SAAA,CAAAf,SAAA,CAAA6C,YAAY,GAAZ,UAAaf,SAAiB;IAC5B,OAAO,CAAC,CAAC,IAAI,CAACZ,SAAS,CAACY,SAAS,CAAC,CAACS,MAAM;EAC3C,CAAC;EAEDxB,SAAA,CAAAf,SAAA,CAAA8C,sBAAsB,GAAtB,UAAuBtB,eAAuB,EAAEuB,eAAuB;IAAvE,IAAAf,KAAA;IACE,IAAI,CAACb,eAAe,CAAC4B,eAAe,CAAC,GAAG;MACtCrB,UAAU,EAAE,KAAK;MACjBF,eAAe,EAAAA,eAAA;MACfuB,eAAe,EAAAA,eAAA;MACftB,OAAO,EAAE,SAAAA,QAACuB,KAAK;QACbhB,KAAI,CAACU,eAAe,CAACK,eAAe,EAAEC,KAAK,CAAC;MAC9C;KACD;EACH,CAAC;EAEDjC,SAAA,CAAAf,SAAA,CAAAiD,kBAAkB,GAAlB;IACE,IAAIC,SAAS,CAACC,QAAQ,EAAE;MACtB,OAAOD,SAAS,CAACE,aAAa,CAAC,IAAI,CAACjD,MAAM,CAACC,IAAI,EAAE,oBAAoB,EAAE,EAAE,CAAC;KAC3E,MAAM;MACL,OAAOiD,OAAO,CAACC,OAAO,CAAC;QAAEC,OAAO,EAAE;MAAE,CAAE,CAAC;;EAE3C,CAAC;EAEDxC,SAAA,CAAAf,SAAA,CAAAS,IAAI,GAAJ;IACE,IAAI,CAACQ,MAAM,GAAG,IAAI;EACpB,CAAC;EACH,OAAAF,SAAC;AAAD,CAAC,EAzGD;;AA2GA,IAAMyC,oBAAoB,GAAG,SAAvBA,oBAAoBA,CAAItD,MAAiB;EAC7C,OAAOA,MAAM,CAACC,MAAM,CAACsD,SAAS,IAAIvD,MAAM,CAACC,MAAM,CAACsD,SAAS,CAACpB,OAAO,CAACa,SAAS,CAACQ,QAAQ,CAAC,IAAI,CAAC;AAC5F,CAAC;AAED;;;;;;AAMA,OAAO,IAAMC,eAAe,GAAG,SAAlBA,eAAeA,CAAIC,YAAiB;EAC/C,IAAI9D,OAAO,GAAGgB,UAAU,CAACJ,UAAU,EAAE;EACrC,KAAmB,IAAAmD,EAAA,IAAO,EAAPC,SAAA,GAAAhE,OAAO,EAAP+D,EAAA,GAAAC,SAAA,CAAAvB,MAAO,EAAPsB,EAAA,EAAO,EAAE;IAAvB,IAAI3D,MAAM,GAAA4D,SAAA,CAAAD,EAAA;IACbE,cAAc,CAACH,YAAY,EAAE1D,MAAM,CAAC;;AAExC,CAAC;AAED,OAAO,IAAM6D,cAAc,GAAG,SAAjBA,cAAcA,CAAIH,YAAiB,EAAE1D,MAAiB;EACjE;EACA;EACA;EACA,IAAI0D,YAAY,CAACI,cAAc,CAAC9D,MAAM,CAACC,MAAM,CAACC,IAAI,CAAC,IAAI,CAACoD,oBAAoB,CAACtD,MAAM,CAAC,EAAE;IAAE;;EAExF0D,YAAY,CAAC1D,MAAM,CAACC,MAAM,CAACC,IAAI,CAAC,GAAGF,MAAM;AAC3C,CAAC"},"metadata":{},"sourceType":"module"}