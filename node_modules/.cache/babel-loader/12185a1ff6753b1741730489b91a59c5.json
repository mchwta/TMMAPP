{"ast":null,"code":"import { __awaiter, __extends, __generator } from \"tslib\";\nimport { WebPlugin } from './index';\nimport { uuid4 } from '../util';\nvar DevicePluginWeb = /** @class */function (_super) {\n  __extends(DevicePluginWeb, _super);\n  function DevicePluginWeb() {\n    return _super.call(this, {\n      name: 'Device',\n      platforms: ['web']\n    }) || this;\n  }\n  DevicePluginWeb.prototype.getInfo = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var ua, uaFields;\n      return __generator(this, function (_a) {\n        ua = navigator.userAgent;\n        uaFields = this.parseUa(ua);\n        return [2 /*return*/, Promise.resolve({\n          model: uaFields.model,\n          platform: 'web',\n          appVersion: '',\n          appBuild: '',\n          appId: '',\n          appName: '',\n          operatingSystem: uaFields.operatingSystem,\n          osVersion: uaFields.osVersion,\n          manufacturer: navigator.vendor,\n          isVirtual: false,\n          uuid: this.getUid()\n        })];\n      });\n    });\n  };\n  DevicePluginWeb.prototype.getBatteryInfo = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      var battery, e_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            battery = {};\n            _a.label = 1;\n          case 1:\n            _a.trys.push([1, 3,, 4]);\n            return [4 /*yield*/, navigator.getBattery()];\n          case 2:\n            battery = _a.sent();\n            return [3 /*break*/, 4];\n          case 3:\n            e_1 = _a.sent();\n            return [3 /*break*/, 4];\n          case 4:\n            return [2 /*return*/, Promise.resolve({\n              batteryLevel: battery.level,\n              isCharging: battery.charging\n            })];\n        }\n      });\n    });\n  };\n  DevicePluginWeb.prototype.getLanguageCode = function () {\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        return [2 /*return*/, {\n          value: navigator.language\n        }];\n      });\n    });\n  };\n  DevicePluginWeb.prototype.parseUa = function (_ua) {\n    var uaFields = {};\n    var start = _ua.indexOf('(') + 1;\n    var end = _ua.indexOf(') AppleWebKit');\n    if (_ua.indexOf(') Gecko') !== -1) {\n      end = _ua.indexOf(') Gecko');\n    }\n    var fields = _ua.substring(start, end);\n    if (_ua.indexOf('Android') !== -1) {\n      uaFields.model = fields.replace('; wv', '').split('; ').pop().split(' Build')[0];\n      uaFields.osVersion = fields.split('; ')[1];\n    } else {\n      uaFields.model = fields.split('; ')[0];\n      if (navigator.oscpu) {\n        uaFields.osVersion = navigator.oscpu;\n      } else {\n        if (_ua.indexOf('Windows') !== -1) {\n          uaFields.osVersion = fields;\n        } else {\n          var lastParts = fields.split('; ').pop().replace(' like Mac OS X', '').split(' ');\n          uaFields.osVersion = lastParts[lastParts.length - 1].replace(/_/g, '.');\n        }\n      }\n    }\n    if (/android/i.test(_ua)) {\n      uaFields.operatingSystem = 'android';\n    } else if (/iPad|iPhone|iPod/.test(_ua) && !window.MSStream) {\n      uaFields.operatingSystem = 'ios';\n    } else if (/Win/.test(_ua)) {\n      uaFields.operatingSystem = 'windows';\n    } else if (/Mac/i.test(_ua)) {\n      uaFields.operatingSystem = 'mac';\n    } else {\n      uaFields.operatingSystem = 'unknown';\n    }\n    return uaFields;\n  };\n  DevicePluginWeb.prototype.getUid = function () {\n    var uid = window.localStorage.getItem('_capuid');\n    if (uid) {\n      return uid;\n    }\n    uid = uuid4();\n    window.localStorage.setItem('_capuid', uid);\n    return uid;\n  };\n  return DevicePluginWeb;\n}(WebPlugin);\nexport { DevicePluginWeb };\nvar Device = new DevicePluginWeb();\nexport { Device };","map":{"version":3,"names":["WebPlugin","uuid4","DevicePluginWeb","_super","__extends","call","name","platforms","prototype","getInfo","ua","navigator","userAgent","uaFields","parseUa","Promise","resolve","model","platform","appVersion","appBuild","appId","appName","operatingSystem","osVersion","manufacturer","vendor","isVirtual","uuid","getUid","getBatteryInfo","battery","getBattery","_a","sent","batteryLevel","level","isCharging","charging","getLanguageCode","value","language","_ua","start","indexOf","end","fields","substring","replace","split","pop","oscpu","lastParts","length","test","window","MSStream","uid","localStorage","getItem","setItem","Device"],"sources":["../../../src/web/device.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module"}